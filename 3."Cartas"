#include <iostream>
using namespace std;

class Nodo {
private:
    int valor;
    Nodo* ant;
    Nodo* sig;

public:
    Nodo(int v) { valor = v; ant = sig = NULL; }

    // Métodos de unión y acceso
    void unirConSig(Nodo* s) { sig = s; }
    void unirConAnt(Nodo* a) { ant = a; }
    Nodo* retSig() { return sig; }
    Nodo* retAnt() { return ant; }
    int retValor() { return valor; }
};

class ListaDoble {
private:
    Nodo* cabeza;
    Nodo* cola;

public:
    ListaDoble() { 
        cabeza = cola = NULL; }

    void insertar(int v) {
        Nodo* nuevo = new Nodo(v);
        if (cabeza == NULL)
            cabeza = cola = nuevo;
        else {
            cola->unirConSig(nuevo);
            nuevo->unirConAnt(cola);
            cola = nuevo;
        }
    }

    void mostrar() {
        Nodo* aux = cabeza;
        while (aux != NULL) {
            cout << aux->retValor() << " ";
            aux = aux->retSig();
        }
        cout << endl;
    }

    void procesar() {
        while (cabeza != cola) { 
            cout << cabeza->retValor() << " ";
            Nodo* mover = cabeza->retSig();
            if (mover != NULL) {
                cabeza->unirConSig(mover->retSig());
                if (mover->retSig() != NULL)
                    mover->retSig()->unirConAnt(cabeza);
                else
                    cola = cabeza; 
                cola->unirConSig(mover);
                mover->unirConAnt(cola);
                mover->unirConSig(NULL);
                cola = mover;
            }
            cabeza = cabeza->retSig();
        }

        cout << endl << "resto: " << cola->retValor() << endl;
    }
};

int main() {
    ListaDoble lista;
    int n;
    cout << "Ingrese n: ";
    cin >> n;

    for (int i = 1; i <= n; i++) {
        lista.insertar(i);
    }

    cout << "Lista original: ";
    lista.mostrar();

    cout << "Salida del proceso: ";
    lista.procesar();

    return 0;
}
